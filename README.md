# Extract Transcribe Load



[//]: # ([![Build Status][build-status-shield]][build-status-url])

[//]: # ([![codecov][code-cov-shield]][code-cov-url])

[//]: # ([![codestyle][code-style]][code-style-url])

## Description
Implementation of Transcription Package for the Project Engineer Exam

## Cloning the repository
```
$ git clone https://github.com/1byte-yoda/transcribe-etl.git
```

## Installing Prerequisites
If you want to run the project in docker, please follow the instruction and install docker from this [link](https://docs.docker.com/get-docker/)

## Setting up environment
The first step in running this project is to setup the environment variables.
Create a copy of the `.env.example` file.
```
$ cp .env.example .env
```

Edit the corresponding values of config values inside the `.env` file.
By default it has the following:
```
CLOUD_URI=simulated_cloud
QA_REPORT_DB_URI=simulated_cloud/qa_report.db
HUGGING_FACE_TOKEN=<PUT-YOUR-TOKEN-HERE>
S3_BUCKET_URI=s3_bucket
```


## Usage

### Using Docker

```
$ docker build -t transcribe_etl .
$ docker run -e ./.env \
     -v $(pwd)/s3_bucket:/usr/src/app/s3_bucket \
     -v $(pwd)/simulated_cloud:/usr/src/app/simulated_cloud \
     -v $(pwd)/stage:/usr/src/app/stage \
     transcribe_etl main.py
```

### Using your Local Computer Running Python3
Just take note that this project was tested and developed using Python 3.9.2, please check if you have the right version installed.
```
$ python --version
Python 3.9.2
```

```
$ pip install -r requirements.txt
$ python3 main.py
```

After running the script `main.py`, the `extract.txt` file shall be moved inside the `stage` folder, and then it will generate the
tx and metadata json files inside the `s3_bucket` folder.

## Project Tree
```
    transcribe-etl/
    │── htmlcov/                            # Autogenerated from pytest 
    │── s3_bucket/                          # Autogenerated pipeline output (Contains the TX JSON Data)
    │── simulated_cloud/                    # Simulation of Cloud Environment
    │   ├── extract_files/                  # Contains .txt files that will be transcribed ie. extract.txt
    │   ├── input_metadata/                 # Contains .csv files that will be mapped for metadata generation ie. input_file.csv
    │   ├── qa_report.db                    # The sqlite database which contains audio transcription metadata 
    │── tests/                              # Contains test suites for pytest
    ├── transcribe_etl/
    │   ├── extract/                        # Stores the Data Extraction Modules
    │   ├── load/                           # Stores the Data Load/Dump Modules
    │   ├── transform/                      # Contains the Annotator for text transcriptions
    │   ├── __init__.py                     # Empty
    │   ├── runner.py                       # Assembles the Data pipeline
    ├── .coveragerc                         # Coverage Report Config
    ├── .editorconfig                       # Code Editor Config
    ├── .env.example                        # Example Environment Config (rename to .env to enable)
    ├── .gitignore                          # Ignored files/folders
    ├── main.py                             # Executes the project
    ├── Makefile                            # The make commands useful for development
    ├── PROJECT.md                          # Project instructions
    ├── pytest.ini                          # Pytest Configuration
    ├── README.md                           # This file
    ├── requirements.txt                    # Python Packages Required for this project
    ├── requirements-dev.txt                # Python Packages Required for development of this project
    ├── tox.ini                             # Flake8 lint configuration
```

## Testing and Development
You will need to install additional package if you want to run test suites and/or develop
for this application.

### Installing Requirements For Development
```
$ pip install -r requirements-dev.txt
```

### Useful Make Commands

#### Running Test Suites
```
$ make test 
```

#### Running Code Autoformat
Note: I am using `max-line-length` of 180
```
$ make black
```

#### Running Flake8 Lint
```
$ make lint
```

#### Generating HTML Test Coverage
The generated report can be found inside the `htmlcov` folder
```
$ make cov_report html
```

[build-status-shield]: https://travis-ci.com/1byte-yoda/ports-automation.svg?branch=main
[build-status-url]: https://travis-ci.com/1byte-yoda/transcribe-etl
[code-cov-shield]: https://codecov.io/gh/1byte-yoda/transcribe-etl
[code-cov-url]: https://codecov.io/gh/1byte-yoda/transcribe-etl
[code-style]: https://img.shields.io/badge/codestyle-flake8-28df99
[code-style-url]: https://github.com/1byte-yoda/transcribe-etl